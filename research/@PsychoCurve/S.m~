function y = S(bResponse,x,t,varargin)
% psychocurve.S
% 
% Description:	compute a measure of the difference between a subject's response
%				for a given stimulus and that predicted by their Weibull
%				psychometric curve (see weibull)
% 
% Syntax:	S = psychocurve.S(bResponse,x,t,[b]=1,[xmin]=0,[g]=0.5,[a]=0.75)
% 
% In:
%	bResponse	- the subject's response to a stimulus
% 	x			- the stimulus value
%	t			- the subject's threshold estimate
%	[b]			- a parameter determining the slope of the curve
%	[xmin]		- the minimum stimulus value
%	[g]			- the minimum expected performance
%	[a]			- the performance at threshold
% 
% Out:
% 	S	- a measure of the difference between the subject's response to the
%		  the stimulus and their response as predicted by their psychometric
%		  curve estimate
% 
% Updated: 2012-02-01
% Copyright 2012 Alex Schlegel (schlegel@gmail.com).  All Rights Reserved.
[b,xmin,g,a]	= ParseArgs(varargin,0.5,1,0,0.5,0.75);

W	= weibull(x,t,b,xmin,g,a);
DW	= dtweibull(x,t,b,xmin,g,a);
y	= (bResponse - W).*DW./(W.*(1-W));

y(isnan(y))	= 0;
